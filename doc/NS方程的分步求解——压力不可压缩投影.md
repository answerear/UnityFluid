

# NS方程的分步求解——压力/不可压缩投影

先来看看我们要求解的压力/不可压缩投影方程：
$$
\frac{\partial \vec{u}}{\partial t}+\frac{1}{\rho}\nabla p = 0\\ 

s.t. \nabla \cdot \vec{u}=0
$$
我们希望最终算出的速度$\vec{u}^{n+1}$ 是无散度的，具体步骤如下：

- 用压力梯度$\nabla p$更新下一个时间步长的速度$\vec{u}^{n+1}$
- 将$\vec{u}^{n+1}$代入无散度公式$\nabla \cdot \vec{u}=0$
- 求出满足速度场无散度的压力场$p$
- 用上一步求出的压力场p再一次更新速度$\vec{u}^{n+1}$

下面我们来看具体的离散化求解步骤：

首先，这里声明一下，为了看起来简单一点，我们统一把表示当前时间步长的上标$n$省略，如果是表示下一个时间步长的值的，我们会用上标$n+1$明确标出来。

接下来，我们来看采用前向欧拉法对**压力梯度**进行离散化的操作，得到：
$$
\nabla p = (\frac {p_{i+1,j}-p_{i,j}}{\Delta x},\frac {p_{i,j+1}-p_{i,j}}{\Delta x})
$$
然后，根据散度的定义对速度散度进行离散化，得到：
$$
\nabla \cdot \vec{u}=\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y} \approx \frac{u_{i+1/2,j}-u_{i-1/2,j}}{\Delta x}+\frac{v_{i+1/2,j}-v_{i-1/2,j}}{\Delta x} =0
$$
用第$n+1$个时间步长的速度来表示，得到：
$$
\frac{u_{i+1/2,j}^{n+1}-u_{i-1/2,j}^{n+1}}{\Delta x}+\frac{v_{i+1/2,j}^{n+1}-v_{i-1/2,j}^{n+1}}{\Delta x} =0
$$
现在，我们需要用压力梯度来表示上式中的速度$u_{i+1/2,j}^{n+1}$，$u_{i-1/2,j}^{n+1}$，$v_{i,j+1/2}^{n+1}$，$v_{i,j-1/2}^{n+1}$

我们通过解偏微分方程$\frac{\vec{u}^{n+1}-\vec{u}^{n}}{\Delta t}+\frac{1}{\rho}\nabla p = 0$得到
$$
u_{i+1/2,j}^{n+1}=u_{i+1/2,j}-\Delta t \frac{1}{\rho}\frac{p_{i+1,j}-p_{i,j}}{\Delta x}\\
u_{i-1/2,j}^{n+1}=u_{i-1/2,j}-\Delta t \frac{1}{\rho}\frac{p_{i-1,j}-p_{i,j}}{\Delta x}\\
v_{i,j+1/2}^{n+1}=v_{i,j+1/2}-\Delta t \frac{1}{\rho}\frac{p_{i,j+1}-p_{i,j}}{\Delta x}\\
v_{i,j-1/2}^{n+1}=v_{i,j-1/2}-\Delta t \frac{1}{\rho}\frac{p_{i,j-1}-p_{i,j}}{\Delta x}
$$
把$u_{i+1/2,j}^{n+1}$，$u_{i-1/2,j}^{n+1}$，$v_{i,j+1/2}^{n+1}$，$v_{i,j-1/2}^{n+1}$代入式(8)，并整理，得到：
$$
\frac{\Delta t}{\rho}(\frac{4p_{i,j}-p_{i+1,j}-p_{i,j+1}-p_{i-1,j}-p_{i,j-1}}{\Delta x ^2})=-(\frac {u_{i+1/2, j}-u_{i-1/2,j}}{\Delta x},\frac {v_{i+1/2, j}-v_{i-1/2,j}}{\Delta x})
$$
这就是我们最终要求解的压力方程。



- 欧拉建立了描述理想流体运动的微分方程；
- 纳维在1761年提出了流体运动的粘度理论；
- 柯西在欧拉方程中引入流体微团的应力张量的概念，推导出了柯西动量方程;
- 结合纳维对粘度的思考和柯西的张量思维，斯托克斯提出了最普适的流体运动方程

作为最普适的流体运动方程，它适用于可压缩变粘度的粘性流体的运动。

三维空间中的N-S方程组的光滑解的存在性问题被美国克雷数学研究所定为七大千禧年数学难题之一，它探讨的是：**NS方程是否对所有时刻的所有起点都有解**，一个光滑解能让向量场中的每一个点都有与其相关的向量，使流体可以“平稳地”在场内流动，而不会陷在那些无从知道下一步该往哪移动的没有向量的点上。

光滑解是物理世界的完整写照，但从数学上讲，它们可能并不总是存在。光滑解要求的是最大化信息量，它们要求在与流体相关的向量场内， 每个点都存在一个向量。但如果我们放松这一要求，比如只需要能够计算某些点上的向量，或者只需对向量的计算进行估算呢？这样的解称为**“弱”解**。如果将光滑解看作是一张有着无限精细的分辨率的流体数学图像，那么弱解就像是这张图片的32位、16位或8位版本，取决于你想要的微弱程度。

这一张图展示了理想中的“光滑”解跟现实中的非唯一“弱”解的对比：

<img src="ppt image/comparision-smooth-and-weak-solution.png" alt="comparision-smooth-and-weak-solution" style="zoom: 67%;" />

<center>光滑解和弱解对比</center>

- 理想中的唯一解：数学家想要证明的是，将 NS 方程应用于任何连续“光滑”的流体而得到的结果是唯一的。

- 现实中的非唯一解：弱矢量场的使用会更加容易，但它无法提供太多的细节信息。数学家发现，一些弱的描述能导致非唯一的结果——仙童的流体从完全相同的起始条件开始，会以不止一种方式流动。

另外根据不同的研究场景，NS方程还可以做一些简化，比如我们更常用的不可压缩流动。

接下来我们就讲一下简化版的NS方程，以及求它的“弱”解的一些方法。